server:
  port: ${PORT:8081}
spring:
  application:
    # the name of the application represents the global identifier of this microservice.
    name: business-process-service
  cloud:
    config:
      uri: ${CONFIG_SERVER_URI:http://localhost:8888}
      # failFast is disabled per default, so that the service can start standalone without config server.
      # failFast should be enabled in production environments.
      # it can be set via an environment variable or the config server
      failFast: ${CONFIG_SERVER_FAILFAST:false}
    discovery:
      # by disabling the service discovery the application/service can be started in "standalone mode".
      # service discovery is disabled by default and should be enabled (set to true) for the "cloud mode".
      # it can be set via an environment variable or the config server
      enabled: ${discovery.enabled:${DISCOVERY_ENABLED:false}}
  datasource:
    url: jdbc:postgresql://${CAMUNDA_DB_HOST:localhost}:${CAMUNDA_DB_PORT:5432}/${CAMUNDA_DB_NAME:camunda}?currentSchema=public
    username: ${CAMUNDA_DB_USERNAME:postgres}
    password: ${CAMUNDA_DB_PASSWORD:nimble}
    driverClassName: org.postgresql.Driver
  jackson:
    date-format: com.fasterxml.jackson.databind.util.ISO8601DateFormat
    serialization:
      WRITE_DATES_AS_TIMESTAMPS: false

springfox:
  documentation:
    swagger:
      v2:
        path: /api-docs

persistence:
  orm:
    business_process:
      hibernate:
        connection:
          url: jdbc:postgresql://${BUSINESS_PROCESS_DB_HOST:localhost}:${BUSINESS_PROCESS_DB_PORT:5432}/${BUSINESS_PROCESS_DB_NAME:businessprocessengine}?currentSchema=public
          username: ${BUSINESS_PROCESS_DB_USERNAME:postgres}
          password: ${BUSINESS_PROCESS_DB_PASSWORD:nimble}
          driver_class: org.postgresql.Driver
        dialect: org.hibernate.dialect.PostgreSQLDialect
        show_sql: false
        hbm2ddl:
          auto: update
        cache:
          provider_class: org.hibernate.cache.HashtableCacheProvider
        jdbc:
          batch_size: 0
        c3p0:
          acquire_increment: 2
          idle_test_period: 60
          min_size: 10
          max_size: 100
          maxStatements: 0
          maxStatementsPerConnection: 100
          timeout: 300
          acquireRetryAttempts: 1
          acquireRetryDelay: 250
          numHelperThreads: 10
        use_sql_comments: true
        transaction:
          factory_class: org.hibernate.transaction.JDBCTransactionFactory
        current_session_context_class: thread
        event:
          merge:
            entity_copy_observer: allow
    ubl:
      hibernate:
        connection:
          #### H2 Configs
#          url: jdbc:h2:file:${user.home}/nimble/ubl;AUTO_SERVER=TRUE;MVCC=TRUE;AUTO_RECONNECT=TRUE;DB_CLOSE_DELAY=10;INIT=create schema IF NOT EXISTS APPS
#          username: sa
#          password:
#          driver_class: org.h2.Driver
#        dialect: org.hibernate.dialect.H2Dialect
          #### Postgres Configs
          url: jdbc:postgresql://${UBL_DB_HOST:localhost}:${UBL_DB_HOST_PORT:5432}/${UBL_DB_NAME:ubldb}?currentSchema=public
          username: ${UBL_DB_USERNAME:postgres}
          password: ${UBL_DB_PASSWORD:nimble}
          driver_class: org.postgresql.Driver
        dialect: org.hibernate.dialect.PostgreSQLDialect
        show_sql: false
        hbm2ddl:
          auto: update
        cache:
          provider_class: org.hibernate.cache.HashtableCacheProvider
        jdbc:
          batch_size: 0
        c3p0:
          acquire_increment: 2
          idle_test_period: 60
          min_size: 10
          max_size: 100
          maxStatements: 0
          maxStatementsPerConnection: 100
          timeout: 300
          acquireRetryAttempts: 1
          acquireRetryDelay: 250
          numHelperThreads: 10
        use_sql_comments: true
        transaction:
          factory_class: org.hibernate.transaction.JDBCTransactionFactory
        current_session_context_class: thread
        event:
          merge:
            entity_copy_observer: allow
    modaml:
      hibernate:
        connection:
          url: jdbc:h2:file://${user.home}/nimble/modaml;AUTO_SERVER=TRUE;MVCC=TRUE;AUTO_RECONNECT=TRUE;DB_CLOSE_DELAY=10;INIT=create schema IF NOT EXISTS APPS
          username: sa
          password:
          driver_class: org.h2.Driver
        dialect: org.hibernate.dialect.H2Dialect
        show_sql: false
        hbm2ddl:
          auto: update
        cache:
          provider_class: org.hibernate.cache.HashtableCacheProvider
        jdbc:
          batch_size: 0
        c3p0:
          acquire_increment: 2
          idle_test_period: 60
          min_size: 10
          max_size: 100
          maxStatements: 0
          maxStatementsPerConnection: 100
          timeout: 300
          acquireRetryAttempts: 1
          acquireRetryDelay: 250
          numHelperThreads: 10
        use_sql_comments: true
        transaction:
          factory_class: org.hibernate.transaction.JDBCTransactionFactory
        current_session_context_class: thread
        event:
          merge:
            entity_copy_observer: allow

logstash:
  uri: ${LOGSTASH_URI:localhost:5000}

camunda:
  bpm:
    webapp:
      index-redirect-enabled: false
    database:
      schema-update: true
      type: postgres
    admin-user:
      id: kermit
      password: superSecret

nimble:
  cors_enabled: false


################################################################################################
################################## KUBERNETES CONFIG ###########################################
################################################################################################

---

spring:
  profiles: kubernetes

nimble:
  cors_enabled: false
  db-credentials-json: ${DB_CREDENTIALS_JSON}

persistence:
  orm:
    business_process:
      hibernate:
        connection:
          url: # set in eu.nimble.service.bp.config.BusinessProcessPersistenceConfig class
          username: # set in eu.nimble.service.bp.config.BusinessProcessPersistenceConfig class
          password: # set in eu.nimble.service.bp.config.BusinessProcessPersistenceConfig class
          driver_class: org.postgresql.Driver
        dialect: org.hibernate.dialect.PostgreSQLDialect
        show_sql: false
        hbm2ddl:
          auto: update
        cache:
          provider_class: org.hibernate.cache.HashtableCacheProvider
        jdbc:
          batch_size: 0
        c3p0:
          acquire_increment: 2
          idle_test_period: 60
          min_size: 10
          max_size: 100
          maxStatements: 0
          maxStatementsPerConnection: 100
          timeout: 300
          acquireRetryAttempts: 1
          acquireRetryDelay: 250
          numHelperThreads: 10
        use_sql_comments: true
        transaction:
          factory_class: org.hibernate.transaction.JDBCTransactionFactory
        current_session_context_class: thread
        event:
          merge:
            entity_copy_observer: allow
      bluemix:
        credentials_json: ${BLUEMIX_BUSINESS_PROCESS_DB_JSON:}
    ubl:
      hibernate:
        connection:
          driver_class: org.postgresql.Driver
        dialect: org.hibernate.dialect.PostgreSQLDialect
        show_sql: false
        hbm2ddl:
          auto: update
        cache:
          provider_class: org.hibernate.cache.HashtableCacheProvider
        jdbc:
          batch_size: 0
        c3p0:
          acquire_increment: 2
          idle_test_period: 60
          min_size: 10
          max_size: 100
          maxStatements: 0
          maxStatementsPerConnection: 100
          timeout: 300
          acquireRetryAttempts: 1
          acquireRetryDelay: 250
          numHelperThreads: 10
        use_sql_comments: true
        transaction:
          factory_class: org.hibernate.transaction.JDBCTransactionFactory
        current_session_context_class: thread
        event:
          merge:
            entity_copy_observer: allow
      bluemix:
        credentials_json: ${BLUEMIX_UBL_DB_JSON:}
    modaml:
      hibernate:
        connection:
          driver_class: org.postgresql.Driver
        dialect: org.hibernate.dialect.PostgreSQLDialect
        show_sql: false
        hbm2ddl:
          auto: update
        cache:
          provider_class: org.hibernate.cache.HashtableCacheProvider
        jdbc:
          batch_size: 0
        c3p0:
          acquire_increment: 2
          idle_test_period: 60
          min_size: 10
          max_size: 100
          maxStatements: 0
          maxStatementsPerConnection: 100
          timeout: 300
          acquireRetryAttempts: 1
          acquireRetryDelay: 250
          numHelperThreads: 10
        use_sql_comments: true
        transaction:
          factory_class: org.hibernate.transaction.JDBCTransactionFactory
        current_session_context_class: thread
        event:
          merge:
            entity_copy_observer: allow
      bluemix:
        credentials_json: ${BLUEMIX_MODAML_DB_JSON:}


################################################################################################
################################### LOCAL DEV CONFIG ###########################################
################################################################################################

---

spring:
  profiles: local_dev
  # Local h2 database
  datasource:
    url: jdbc:h2:mem:AZ;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    driverClassName: org.h2.Driver
    username: sa
    password:
    jpa:
      database-platform: org.hibernate.dialect.H2Dialect
  h2:
    console:
      enabled: true

nimble:
  cors_enabled: true